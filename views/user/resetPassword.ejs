<%- include('./header', {isLogin: isLogin}) %>

<div
  class="d-flex justify-content-center align-items-center"
  style="height: 100vh"
>
  <form
    method="post"
    id="resetPasswordForm"
    action=""
    class="colorlib-form col-md-3"
    style="height: auto"
  >
    <h3 class="text-center" style="margin-bottom: 20px">RESET PASSWORD</h3>
    <div class="row">
      <div class="col-md-12">
        <div class="form-group">
          <input
            type="password"
            id="newPassword"
            class="form-control"
            placeholder="New password"
          />
        </div>

        <div class="form-group">
          <input
            type="password"
            id="confirmNewPassword"
            class="form-control"
            placeholder="Confirm new password"
          />
        </div>
      </div>

      <input
        type="submit"
        class="btn btn-dark"
        style="
          width: 100%;
          border-radius: 10px;
          height: 50px;
          margin-left: 15px;
          margin-right: 15px;
        "
      />
    </div>
  </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  resetPasswordForm.addEventListener("submit", (event) => {
    event.preventDefault();

    const password = document.getElementById("confirmNewPassword");

    axios
      .post("/password/reset", { password: password.value })
      .then((response) => {
        if (response.status == 200) {
          new Noty({
            type: "success",
            text: response.data.msg,
            timeout: 3000, // Duration to display the message (in milliseconds)
            layout: "bottomCenter",
            theme: "relax",
            animation: {
              open: "animated bounceInRight",
              close: "animated bounceOutRight",
            },
            callbacks: {
              afterClose: function () {
                // Redirect to the sign-in page after the notification closes
                window.location.href = "/signin";
              },
            },
          }).show();
        }
      })
      .catch((error) => {
        console.log("it is an error", error);
        if (error.response.status == 409) {
          //   new Noty({
          //     type: "error",
          //     text: error.response.data.message,
          //     timeout: 3000,
          //     layout: "bottomCenter",
          //     theme: "metroui",
          //   }).show();
        }
      });
  });
</script>

<%- include('./footer') %>
